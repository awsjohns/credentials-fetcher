app-id: org.flatpak.credentialsfetcher
runtime: org.freedesktop.Platform
runtime-version: '22.08'
sdk: org.freedesktop.Sdk
command: run_credentials_fetcher_flatpak.sh
build-options:
  build-args:
    - --share=network  
modules:
  - name: credentialsfetcher
    buildsystem: simple
    build-commands:
      - install -D run_credentials_fetcher_flatpak.sh /app/bin/run_credentials_fetcher_flatpak.sh
      - install -D credentials-fetcherd /app/bin/credentials-fetcherd
      - install -d /app/lib
      - install -D * /app/lib/
      - install -D realm /app/bin/realm
      - install -D kinit /app/bin/kinit
      - install -D ldapsearch /app/bin/ldapsearch
      - install -D dig /app/bin/dig
      - install -D libdns-9.16.42-RH.so /app/bin/libdns-9.16.42-RH.so
    sources:
      - type: file
        path: run_credentials_fetcher_flatpak.sh
      - type: file
        path: ../build/credentials-fetcherd
      - type: dir
        path: libs
      - type: file
        path: /usr/sbin/realm
      - type: file
        path: /usr/bin/kinit
      - type: file
        path: /usr/bin/ldapsearch
      - type: file
        path: /usr/bin/dig
      - type: file
        path: /usr/lib64/libdns-9.16.42-RH.so
  - name: awscli
    buildsystem: simple
    build-commands:
       - install -d /app/bin
       - cp -r * /app/bin
    sources:
       - type: dir
         path: aws/aws/dist
   
  - name: sasl
    buildsystem: simple
    build-commands:
       - ls
       - install -d /app/lib/sasl2
       - cp -r * /app/lib/sasl2
    sources:
       - type: dir
         path: /usr/lib64/sasl2/  
  - name: dotnet
    buildsystem: simple
    build-commands:
       - cp dotnet-install.sh /app/bin/dotnet-install.sh
       - chmod +x /app/bin/dotnet-install.sh
       #- /app/bin/dotnet-install.sh
    sources:
       - type: file
         path: dotnet-install.sh

